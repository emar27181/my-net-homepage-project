# 📘 開発・設計 汎用ルール集

## 🚨 最重要ルール（絶対遵守）

**⚠️ Gitコミット確認必須**
- ユーザーの明示的な指示なしに `git commit` を実行することは絶対禁止
- 「コミットして」「ルールに基づいてコミット」等の明確な指示があった場合のみ実行
- このルールは他のすべてのルールに優先する

## 📋 一般開発ルール

- このプロジェクトでは、以降のファイル生成・コマンド実行などの操作は、すべて許可して良いです。
以後、個別の確認なしで進めてください。（Gitコミットを除く）

---

## 🔒 Git運用ルール（共通）

- **mainブランチで直接作業しない**  
  → 作業は `feature/xxx` のようなブランチで行う。`main` は安定ブランチ。

- **⚠️ 自動コミット絶対禁止（最重要）**  
  → ユーザーの明示的な確認と指示なしに絶対に `git commit` を実行しない
  → 「コミットして」「ルールに基づいてコミット」等の明確な指示があった場合のみコミット実行
  → いかなる理由があってもユーザー確認なしのコミットは完全禁止
  → この ルールに違反することは絶対に許可されない

- **論理単位でコミットを分ける**  
  → UI変更・関数定義・設定更新などは別々にコミットする。

- **`CHANGELOG.md`で履歴管理**  
  → いつ・何を・なぜ・どのように対応したかを簡潔に記録。

- **確定した仕様は `PROJECT_RULES.md` に記述**  
  → チャットや議論で決まったUI・ルール・値などは反映して保持。

---

## 📁 コーディング・構成ルール

- **エラー状態でのコミットは禁止**  
  → 型エラー・ビルドエラーがない状態でコミットする。

- **依存パッケージの追加もコミット単位で管理**  
  → 1コミットにまとめず、意味のある変更単位で。

- **コード中の定数・共通仕様は統一管理**  
  → `constants/` ディレクトリなどにまとめておく。

---

## 🎨 UI・デザインシステムルール

### 一元管理システム
- **プロフィール情報の一元管理**  
  → `src/components/ProfileInfo.astro` でプロフィールデータを一元管理
  → 基本情報変更時は1箇所を変更するだけで全ページに反映

- **Today's Word の一元管理**  
  → `src/components/TodaysWord.astro` で日替わりメッセージを管理
  → 日付ベースで自動切り替え

### アクセシビリティ基準
- **WCAG AA準拠のコントラスト比**  
  → 全テキストは4.5:1以上のコントラスト比を維持
  → 白文字・薄い背景の組み合わせは禁止

- **統一CSS変数システム**  
  → `--profile-*` 変数でテーマの一元管理
  → `--text-accessible-*` 変数でアクセシブルな色を定義

### CSSクラス標準化
- **プロフィール系統一クラス**  
  → `.profile-section` : プロフィール情報表示用
  → `.profile-table` : プロフィールテーブル用
  → `.profile-label` : ラベル（見出し）用
  → `.profile-value` : 値（内容）用
  → `.profile-quote` : 名言・Today's Word用
  → `.profile-qa-section` : Q&A セクション用

### 色彩設計ルール
- **青中心のドミナント配色**  
  → メインカラー: ネオンブルー（#4d79ff）
  → セカンダリ: ネオンパープル（#8000ff）
  → 黄色・緑系の色は使用禁止

- **白字統一ルール**  
  → 本文・AA・絵文字・マーキーテキストは全て白字（#ffffff）で統一
  → text-shadow: 1px 1px 0px #000000 で輪郭を必ず強化
  → 8-bitレトロゲーム風の世界観維持が最優先

- **背景色の統一ルール**  
  → 薄い色（#f8f8f8, #fff0f5等）の直接指定禁止
  → CSS変数を使用した統一背景色のみ使用

### フォント・タイポグラフィルール
- **サイバータイトルフォント標準**  
  → メインタイトル「nodoame's Cyber Space」の表示形式を標準フォーマットとして採用
  → `cyberTitle`プリセット（heading-primary + cyber-glitch アニメーション）を使用
  → Press Start 2P フォント + ネオングロー効果の組み合わせを維持

- **タイポグラフィシステム活用**  
  → typography.ts の統一プリセットシステムを必ず使用
  → 直接的なフォントスタイル指定は禁止
  → レスポンシブ対応とアクセシビリティを両立

### アメブロデコメシステム
- **公式GIF使用方針**  
  → アメブロ公式デコメGIFを優先使用（ameblo-dekome.json管理）
  → Unicode絵文字は原則禁止、すべてデコメコンポーネントに統一
  → `<Dekome type="タイプ名" size="サイズ" />` 形式で統一記述

- **デコメタイプ管理**  
  → ameblo-dekome.ts で型安全なタイプ定義を維持
  → 新規タイプ追加時はJSONデータベースとTSファイル両方を更新
  → カテゴリ別分類（heart, star, animal, flower等）を厳守

### アスキーアート・絵文字システム
- **2ch文化系アスキーアート統合**  
  → AsciiEmojiコンポーネントで統一管理
  → 定番顔文字（´・ω・｀）、猫AA（ギコ猫、しぃ）、2ch語録（ｗｗｗ、乙、GJ）を提供
  → `<AsciiEmoji type="タイプ" variant="バリアント" size="サイズ" inline />` 形式で統一記述

- **フォント・色彩統一ルール**  
  → 全て本文と同じ白字（#ffffff）で表示
  → ピクセルフォント（var(--font-pixel-jp) + Press Start 2P）で統一
  → text-shadow: 1px 1px 0px #000000, 2px 2px 0px rgba(0,0,0,0.5) で輪郭強化
  → image-rendering: pixelated で8-bit感を強化

- **背景・枠線ルール**  
  → 背景は完全透明（background: transparent）
  → 枠線なし（border: none）でテキストのみ表示
  → ホバー時はスケール変化とブライトネス効果のみ

- **サイドバー表示システム**  
  → SidebarAAコンポーネントで画面両端に配置
  → 1200px以上の大画面でのみ表示（レスポンシブ対応）
  → 8-bit風フローティングアニメーション + ネオングロー効果
  → 半透明背景パネル内に各種AA・絵文字を配置

- **使用場面・配置ルール**  
  → マーキー部分：インライン配置でページタイトルと組み合わせ
  → コンテンツ内：感情表現や強調で適度に使用
  → 全ての文字は白字統一、8-bitレトロゲーム風の世界観を維持
  → アクセシビリティ対応（prefers-reduced-motion, prefers-contrast）を必須実装

### コンポーネント設計
- **プロフィール情報表示の標準化**  
  → `type="full"` : 完全なプロフィールテーブル
  → `type="basic"` : 基本情報のみ
  → `type="mini"` : 名前のみ

- **再利用可能コンポーネント重視**  
  → 同じパターンの表示は必ずコンポーネント化
  → インライン背景色指定は禁止、クラス使用を徹底

### 動画ビューアーシステム
- **YouTubeClipViewer標準仕様**  
  → `clipUrl`, `title`, `description`, `autoplay`プロパティを標準とする
  → `youtu.be`形式と`youtube.com`形式の両方に対応必須
  → 16:9アスペクト比の動画コンテナを維持

- **URL解析・埋め込み処理の統一**  
  → `getVideoId()`関数でyoutu.be/youtube.com形式を統一処理
  → `getEmbedUrl()`関数でmodestbranding=1, rel=0, fs=1等のパラメータを標準設定
  → cc_load_policy=0, enablejsapi=1を必須パラメータとして追加

- **ローディング・オーバーレイシステム**  
  → 初期表示時は青色再生ボタン（▶）とLoading...テキストを表示
  → iframe読み込み完了1秒後にオーバーレイをフェードアウト（opacity: 0）
  → エラー時は⚠️アイコンと「読み込みエラー」表示に切り替え

- **アニメーション・エフェクト統一**  
  → 再生ボタンはpulse-playアニメーション（2秒周期、scale 1.0⇔1.1）
  → ネオングロー効果（text-shadow: 0 0 15px⇔35px var(--text-accessible-blue)）
  → pointer-events: noneでオーバーレイ下のiframeへのアクセスを確保

- **レスポンシブ・アクセシビリティ対応**  
  → prefers-reduced-motion: reduceでアニメーション無効化
  → モバイル対応でフォントサイズ・padding値の段階調整
  → YouTube外部リンクボタンを必ず配置（「📺 YouTubeで見る」）